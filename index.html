<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta http-equiv="X-UA-Compatible" content="ie=edge">
  <title>loading</title>
  <style>
    * { margin: 0; padding: 0 }
    html, body {
      width: 100%;
      height: 100%;
    }
    .messages-bar-dc {
      width: 100vw;
      height: 100vh;
      position: fixed;
      top: 0;
      left: 0;
    }
    .mask-dc {
      width: 100%;
      height: 100%;
      position: absolute;
      top: 0;
      left: 0;
      background-color: rgba(0,0,0, .4);
    }
    .messages-dc {
      width: 300px;
      max-height: 270px;
      padding: 15px;
      background-color: white;
      border-radius: 5px;
      position: absolute;
      top: calc(50% - 150px);
      left: calc(50% - 165px);
    }
    .title {
      font-size: 19px;
      padding-bottom: 5px;
      margin-bottom: 10px;
      border-bottom: 1px solid #ccc;
    }
    .btns {
      width: 100%;
      border-top: 1px solid #ccc;
      margin-top: 10px;
      padding-top: 10px;
      text-align: right;
    }
    .btns div {
      width: 60px;
      height: 20px;
      padding: 5px;
      display: inline-block;
      text-align: center;
      color: white;
      border-radius: 3px;
      cursor: pointer;
    }
    .btns div:hover {
      opacity: .8;
    }
    .cancel {
      background-color: #1089ff;
    }
    .confim {
      background-color: #009975;
      margin-left: 30px;
    }
  </style>
</head>
<body>
    <!-- <div class="messages-bar-dc">
      <div class="mask-dc"></div>
      <div class="messages-dc">
        <div class="title">提示</div>
        <div class="content">dasda</div>
        <div class="btns">
          <div class="cancel">取 消</div>
          <div class="confim">确 定</div>
        </div>
      </div>
    </div> -->
</body>
<script>
  /**
  * Messages - 弹窗
  * msg - 弹出的文字
  * title - 确认框的标题
  * function - 确认框确定之后执行的函数
  */
  class Messages {
    constructor() {
      this.obj = null
      this.msgNodes = {
        bar: {
          obj: null,
          parent: null,
          style: {
            fontSize: '14px',
            padding: '5px 10px',
            color: 'white',
            borderRadius: '4px',
            position: 'fixed',
            bottom: '5vh',
            left: 0,
            backgroundColor: '#525252',
            opacity: 0,
            transition: 'opacity .5s'
          },
          text: null
        }
      }
      this.nodes = {
        bar: {
          obj: null,
          parent: null,
          style: {
            width: '100vw',
            height: '100vh',
            position: 'fixed',
            top: 0,
            left: 0
          },
          text: null
        },
        mask: {
          obj: null,
          parent: 'bar',
          style: {
            width: '100%',
            height: '100%',
            position: 'absolute',
            top: 0,
            left: 0,
            backgroundColor: 'rgba(0,0,0, .4)'
          },
          text: null
        },
        messages: {
          obj: null,
          parent: 'bar',
          style: {
            width: '300px',
            maxHeight: '270px',
            padding: '15px',
            backgroundColor: 'white',
            borderRadius: '5px',
            position: 'absolute',
            top: 'calc(50% - 150px)',
            left: 'calc(50% - 165px)'
          },
          text: null
        },
        title: {
          obj: null,
          parent: 'messages',
          style: {
            fontSize: '19px',
            paddingBottom: '5px',
            marginBottom: '10px',
            borderBottom: '1px solid #ccc'
          },
          text: '提示'
        },
        content: {
          obj: null,
          parent: 'messages',
          style: {
            fontSize: '16px',
          },
          text: null
        },
        btns: {
          obj: null,
          parent: 'messages',
          style: {
            width: '100%',
            borderTop: '1px solid #ccc',
            marginTop: '10px',
            paddingTop: '10px',
            textAlign: 'right',
          },
          text: null
        },
        cancel: {
          obj: null,
          parent: 'btns',
          style: {
            backgroundColor: '#1089ff'
          },
          text: '取 消'
        },
        confim: {
          obj: null,
          parent: 'btns',
          style: {
            backgroundColor: '#009975',
            marginLeft: '30px'
          },
          text: '确 定'
        }
      }
    }
    init(m) { // 判断是提示框还是确认框
      if (typeof m === 'string') {
        this.msg(m)
      } else {
        this.confim(m)
      }
    }
    msg(m) { // 提示框
      this.addDom('msgNodes', 'bar', m)
        .then(() => {
          const w = this.msgNodes['bar'].obj.clientWidth
          this.msgNodes['bar'].obj.style.left = `calc(50vw - ${w}px/2)`
          this.msgNodes['bar'].obj.style.opacity = 1
          setTimeout(() => { this.msgNodes['bar'].obj.style.opacity = 0 }, 2500)
          setTimeout(() => this.clean('msgNodes'), 3000)
        })
        .catch(err => {
          console.error('创建失败！！！' + err)
        })
    }
    confim(m) { // 确认框 确定 - 取消
      this.nodes['title'].text = m.title || '提示'
      this.addDom('nodes', 'content', m.msg)
        .then(() => {
          const cancel = this.nodes['cancel'].obj
          const confim = this.nodes['confim'].obj
          cancel.addEventListener('mouseover', () => this.onmouseover(cancel), false)
          cancel.addEventListener('mouseleave', () => this.onmuseleave(cancel), false)
          confim.addEventListener('mouseover', () => this.onmouseover(confim), false)
          confim.addEventListener('mouseleave', () => this.onmuseleave(confim), false)
          
          cancel.addEventListener('click', () => this.clean('nodes'), false)
          confim.addEventListener('click', () => {
            if (m.function) m.function()
            this.clean('nodes')
          }, false)
          this.nodes['mask'].obj.addEventListener('click', () => this.clean('nodes'), false)
        })
        .catch(err => {
          console.error('创建失败'+err)
        })
    }
    addDom(n, m, t) { // 添加dom元素
      return new Promise((resolve, reject) => {
        try {
          this[n][m].text = t
            for (var key in this[n]) {
            const temp = this[n][key]
            const parent = temp.parent === null ? document.getElementsByTagName('body')[0] : this[n][temp.parent].obj
            temp.obj = this.createDom('div', temp.style, key, temp.text)
            parent.append(temp.obj)
          }
          resolve()
        } catch {
          reject()
        }
      })
    }
    createDom(node, style = {}, className, text) { // 创建DOM以及css样式赋值
      const obj = document.createElement(node)
      for(var key in style) {
        obj.style[key] = style[key]
      }
      if (className) {
        obj.className = className
      }
      if (text) {
        obj.innerText = text
      }
      return obj
    }
    /*
    * 确认框按钮鼠标悬浮
    * onmouseover - 鼠标悬浮
    * onmuseleave - 鼠标离开
    */
    onmouseover(obj) {
      obj.style.opacity = .8
    }
    onmuseleave(obj) {
      obj.style.opacity = 1
    }
    clean(name) { // 清除元素
      this[name]['bar'].obj.parentElement.removeChild(this[name]['bar'].obj)
      for (let key in this[name]) {
        this.nodes[key].obj = null
      }
    }
  }

  const msg = new Messages()
</script>
</html>
